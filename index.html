<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description"
          content="SeTok: Towards Semantic-equivalent Tokenization for MLLM">
    <meta name="keywords" content="Multimodal Large Language Models">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SeTok</title>

    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-PYVRSFMDRL');
    </script>

    <link href="https://fonts.cdnfonts.com/css/caveat" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
          rel="stylesheet">
    <link rel="icon" href="./static/images/logo.png">
    <link rel="stylesheet" href="./static/css/bulma.min.css">
<!--    <link rel="stylesheet" href="bulma-carousel.min.css">-->
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">

    <link rel="stylesheet" href="./static/css/index-gradio.css">
    <link rel="stylesheet" href="./static/css/live_theme.css">

    <style>
        @import url('https://fonts.cdnfonts.com/css/caveat');
    </style>

<!--    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>-->
    <script defer src="./static/js/fontawesome.all.min.js"></script>
<!--    <script src="./static/js/bulma-carousel.min.js"></script>-->
<!--    <script src="./static/js/bulma-slider.min.js"></script>-->
    <script src="./static/js/index.js"></script>

<!--    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"-->
<!--          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">-->
</head>
<body>


<section class="hero">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <!-- <h1 class="title is-1 publication-title" -->
                        <!-- style="display: flex;flex-direction: row;align-items: center;justify-content: center;margin-bottom: 5px;"><img -->
                            <!-- src="./static/images/logo.png" width="60" height="60" style="margin-right: 25px;margin-bottom: 6px;"></h1> -->
                    <h1 class="title is-2 publication-title">Towards Semantic Equivalence of Tokenization in Multimodal LLM</h1>
<!--                     <h1 class="title is-2 publication-title" style="margin-top: -25px">Understanding, Generating, Segmenting, Editing</h1> -->
                    <div class="is-size-5 publication-authors">
            <span class="author-block">
                <a href="https://chocowu.github.io/">Shengqiong Wu</a><sup>1,2</sup></span> &nbsp;
                        <span class="author-block">
                <a href="https://haofei.vip/">Hao Fei</a><sup>1,2</sup> </span> &nbsp;
                        <span class="author-block">
                <a href="https://lxtgh.github.io/">Xiangtai Li</a><sup>2</sup> </span> &nbsp;
                    <span class="author-block">
                <a href="https://scholar.google.com/citations?user=xp_rICcAAAAJ&hl=zh-CN">Jiayi Ji</a><sup>1</sup> </span> &nbsp;
                    <span class="author-block">
              <a href="https://personal.ntu.edu.sg/hanwangzhang/">Hanwang Zhang</a><sup>2,3</sup></span> &nbsp;
                        <span class="author-block">
              <a href="https://www.chuatatseng.com/">Tat-Seng Chua</a><sup>1</sup></span> &nbsp;
                        <span class="author-block">
              <a href="https://yanshuicheng.info/">Shuicheng Yan</a><sup>2</sup>
            </span>
                    </div>

                    <div class="is-size-5 publication-authors" style="margin-top: 10px;">
                        <span class="author-block"><b style="color:#f68946; font-weight:normal">▶ </b><sup>1</sup>National University of Singapore</span> &nbsp;
                        <span class="author-block"><b
                                style="color:#008AD7; font-weight:normal">▶ </b><sup>2</sup>Skywork AI, Singapore</span> &nbsp;
                        <span class="author-block"><b
                                style="color:#00d754; font-weight:normal">▶ </b><sup>3</sup>Nanyang Technological University</span>
                    </div>

                    <!-- <div class="is-size-5 publication-authors">
                        <span class="author-block" style="font-size: 15px;">(<sup>*</sup>Correspondence)</span>
                    </div> -->

                    <div class="column has-text-centered">
                        <div class="publication-links">
                            <!-- PDF Link. -->
                            <span class="link-block">
                                <a href="https://arxiv.org/abs/2406.05127" class="external-link button is-normal is-rounded is-dark">
                                <span class="icon">
                                    <i class="fas fa-file-pdf"></i>
                                </span>
                                <span>Paper</span>
                            </a>
                        </span>

                <!-- <span class="link-block">
                    <a href="xxx" target="_blank" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fa fa-laugh"></i>
                    </span>
                    <span>Demo</span>
                    </a>
                </span> -->
                
                <!-- Video Link. -->
                <!-- <span class="link-block">
                    <a href="xxx" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fab fa-youtube"></i>
                    </span>
                    <span>Video</span>
                    </a>
                </span> -->


                <!-- Code Link. -->
                <span class="link-block">
                    <a href="https://github.com/ChocoWu/SeTok"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                    </a>
                </span>


                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<section class="section">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-full-width">
                <h2 class="title is-2">Abstract</h2>
                <div class="content has-text-justified">
                    <p>
                        Multimodal Large Language Models (MLLMs) have demonstrated exceptional capabilities in processing vision-language tasks.
                        One of the crux of MLLMs lies in vision tokenization, which involves efficiently transforming input visual signals into feature representations that are most beneficial for LLMs.
                        However, existing vision tokenizers, essential for semantic alignment between vision and language, remain problematic.
                        Existing methods aggressively fragment visual input, corrupting the visual semantic integrity.
                        To address this, this paper proposes a novel dynamic Semantic-Equivalent Vision Tokenizer (<b>SeTok</b>), which groups visual features into semantic units via a dynamic clustering algorithm, flexibly determining the number of tokens based on image complexity.
                        The resulting vision tokens effectively preserve semantic integrity and capture both low-frequency and high-frequency visual features.
                        The proposed MLLM (<b>Setokim</b>) equipped with SeTok significantly demonstrates superior performance across various tasks, as evidenced by our experimental results.
                    </p>
                </div>
                <div class="content has-text-justified">
                    <img class="columns is-centered has-text-centered" src="./static/images/intro.jpeg" alt="Teaser" width="100%"
                         style="margin:0 auto">
                    <br>
                    <figcaption>
                        <p style="text-align: left;">
                            <font color="061E61">
                                <b>Figure 1:</b> Comparison between existing MLLMs in tokenized visual inputs: (a) patch-level continuous token, (b) patch-level discrete token, (c) learnable query token, and (d) semantic-equivalent continuous token (ours).
                                In (e), we show four language-driven vision tasks enhanced with semantic-equivalent vision tokens, with token masks showing regions of the same color representing a single vision token.
                            </font>
                        </p>
                    </figcaption>
                </div>
            </div>
        </div>
    </div>
</section>


<section class="section">
    <div class="container is-max-desktop">
        <div class="columns is-centered has-text-centered">
            <div class="column is-full-width">
                <h2 class="title is-2">Method</h2>
                <div class="content has-text-justified">
                    <p>
                        <b>SeTok</b> tokenizes visual features extracted from an image by a vision encoder into semantically equivalent vision tokens, which then are fed into a detokenizer to reconstruct the image and meanwhile employed to perform the concept-level image-text alignment. 
                    </p>
                </div>
                <div class="content has-text-justified">
                    <img class="columns is-centered has-text-centered" src="./static/images/setok.jpg" alt="Teaser" width="100%"
                         style="margin:0 auto">
                    <br>
                    <figcaption>
                        <p style="text-align: center;">
                            <font color="061E61">
                                <b>Figure 2:</b> Overview of <b>SeTok</b>. 
                                
                            
                            </font>
                        </p>
                    </figcaption>
                </div>
                <div>
                    <!-- <h2 class="title is-2">Vision Cluster</h2> -->
                    <div class="content has-text-justified">
                        <p>
                            Upon acquiring <b>SeTok</b>, we propose to integrate it with the pre-trained LLM to construct an MLLM, i.e., <b>Setokim</b>.
                            The overall framework is depicted in Figure 3.
                            The input image will be tokenized into a sequence of semantic-equivalent visual tokens by <b>SeTok</b>, which are then concatenated with text tokens to form a unified multimodal sequence. 
                            To effectively distinguish between modalities and facilitate visual content generation, two special tokens, '<em>[Img]</em>' and '<em>[/Img]</em>' are introduced to signify the beginning and the end of the visual sequence, respectively.
                            The backbone LLM subsequently processes this multimodal sequence to perform multimodal understanding and generation. 
                            The output vision tokens are then fed into the visual detokenizer to restore the images.
                            To exploit this spatial and semantic encoding, we incorporate a lightweight mask decoder utilizing the generated vision tokens as input to yield the referring mask.
                        </p>
                    </div>
                </div>
                <div class="content has-text-justified">
                    <img class="columns is-centered has-text-centered" src="./static/images/framework.jpeg" alt="Teaser" width="50%"
                         style="margin:0 auto">
                    <br>
                    <figcaption>
                        <p style="text-align: center;">
                            <font color="061E61">
                                <b>Figure 3:</b> Overview of <b>SeTokim</b>. 
                            </font>
                        </p>
                    </figcaption>
                </div>
            </div>
        </div>


        <!-- Training -->
        <div class="columns is-centered">
            <div class="column is-full-width">
                <h2 class="title is-3">Training</h2>

                <div class="content has-text-justified">
                    <p>
                        We train the Setokim to endow it with robust vision understanding and task execution capabilities, with three distinct phases.
                    <ul>
                        <li>
                            <b>Step-I: Tokenizer Pretraining.</b>
                            This stage aims to truly endow the tokenizer with the capability of tokenizing the input vision into a semantic complement and independent tokens that can capture the low-frequency semantic features and high-frequency pixel features. 

                        </li>
                        <li>
                            <b>Step-II: Multimodal Pretraining.</b>
                            In this phase, we enhance the LLM to possess interleaved understanding and generation capabilities for vision-language tasks.
                        </li>
                        <li>
                            <b>Step-III: Instruction Tuning.</b>
                            We perform multimodal instruction tuning through fine-tuning LLM using a LoRA module with both public datasets covering fine-grained visual QA, image generation and editing, and text-rich grounded datasets.
                        </li>
                    </ul>
                    </p>
                </div>
                <br/>

            </div>
        </div>
    </div>
</section>


<section class="section">
    <div class="container is-max-desktop">

        <div class="columns is-centered has-text-centered">
            <h2 class="title is-2">Qualitative Analysis</h2>
            <br>
        </div>

        <div class="columns is-centered">
            <div class="column is-full-width">
                <h4 class="title is-3">• Visual Understanding and Generation</h4>

                <div class="content has-text-justified">
                    <img class="columns is-centered has-text-centered" src="./static/images/visual-under.jpeg" alt="Teaser" width="95%"
                         style="margin:0 auto">
                    <br>
                    <figcaption>
                        <p style="text-align: left;">
                            <font color="061E61">
                                <b>Figure 3:</b> Qualitative results on image understanding and generation.
                                The <span style="color: rgb(39,190,110);">words</span> marked in green are key elements in questions and answers.
                            </font>
                        </p>
                    </figcaption>
                </div>
                <br/>

            </div>
        </div>

        <div class="columns is-centered">
            <div class="column is-full-width">
                <h4 class="title is-3">• Visual segmentation</h4>

                <div class="content has-text-justified">
                    <img class="columns is-centered has-text-centered" src="./static/images/segmentation.jpeg" alt="Teaser" width="95%"
                         style="margin:0 auto">
                    <br>
                    <figcaption>
                        <p style="text-align: center;">
                            <font color="061E61">
                                <b>Figure 4:</b> The visualizations for segmentation results compared with GLaMM and Ospery.
                            </font>
                        </p>
                    </figcaption>
                </div>
                <br/>

            </div>
        </div>


        <div class="columns is-centered">
            <div class="column is-full-width">
                <h4 class="title is-3">• Visual Editing</h4>

                <div class="content has-text-justified">
                    <img class="columns is-centered has-text-centered" src="./static/images/visual-editing.jpeg" alt="Teaser" width="95%"
                         style="margin:0 auto">
                    <br>
                    <figcaption>
                        <p style="text-align: left;">
                            <font color="061E61">
                                <b>Figure 5:</b> Qualitative comparison between MLLMs for the image editing. 
                                <b>Setokim</b> excels in adhering to instructions and preserving low-level image details.
                            </font>
                        </p>
                    </figcaption>
                </div>
                <br/>

            </div>
        </div>
        
        <div class="columns is-centered">
            <div class="column is-full-width">
                <h4 class="title is-3">• Visual Tokens</h4>

                <div class="content has-text-justified">
                    <img class="columns is-centered has-text-centered" src="./static/images/cluster.png" alt="Teaser" width="95%"
                         style="margin:0 auto">
                    <br>
                    <figcaption>
                        <p style="text-align: center;">
                            <font color="061E61">
                                <b>Figure 6:</b> The visualizations for visual tokens.
                            </font>
                        </p>
                    </figcaption>
                </div>
                <br/>

            </div>
        </div>
        

        <div class="columns is-centered">
            <div class="column is-full-width">
                <h4 class="title is-3">• Reconstructions</h4>

                <div class="content has-text-justified">
                    <img class="columns is-centered has-text-centered" src="./static/images/reconstruction.jpeg" alt="Teaser" width="95%"
                         style="margin:0 auto">
                    <br>
                    <figcaption>
                        <p style="text-align: center;">
                            <font color="061E61">
                                <b>Figure 7:</b> The image reconstruction results from visual tokens by the denoising U-Net.
                            </font>
                        </p>
                    </figcaption>
                </div>
                <br/>

            </div>
        </div>

    </div>
</section>



<section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
        <h2 class="title">BibTeX</h2>
        <pre><code>@article{wu2024towards,
  title={Towards Semantic Equivalence of Tokenization in Multimodal LLM},
  author={Wu, Shengqiong and Fei, Hao and Li, Xiangtai and Ji, Jiayi and Zhang, Hanwang and Chua, Tat-Seng and Yan, Shuicheng},
  journal={arXiv preprint arXiv:2406.05127},
  year={2024}
}
</code></pre>
    </div>
</section>


<footer class="footer">
    <div class="container">
        <div class="columns is-centered">
            <div class="column is-8">
                <div class="content">
                    <p style="text-align: center;">
                        The webpage is built based on <a href="https://next-gpt.github.io/">NExT-GPT</a>.
                    </p>
                </div>
            </div>
        </div>
    </div>
</footer>

</body>
</html>
